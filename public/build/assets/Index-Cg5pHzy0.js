import{V as F,r as o,a as R,j as e,M as U,U as q,h as G}from"./app-Cegcm5kP.js";import{A as B}from"./AuthenticatedLayout-DtXB4yAw.js";import{d as V}from"./index-BfQLVr1a.js";import{M as $}from"./Modal-DRG4MLRd.js";import{S as H}from"./sweetalert2.esm.all-B0Dix5B2.js";import{P as z}from"./Pagination-D1wEGoFR.js";import{M as b}from"./MiInput-CEkF_wN6.js";import{M as f}from"./MiLista-PpBLvJ2v.js";import{M as J}from"./MiTextArea-iPUdR226.js";import"./transition-CxfPntE9.js";function pe(i,j){const y=F().props.auth.user,[_,n]=o.useState(!1),[N,p]=o.useState(""),[X,v]=o.useState(1),[C,w]=o.useState(j.search||""),[K,S]=o.useState(""),[u,d]=o.useState(null);o.useState(i.conjunto),o.useEffect(()=>{const a=new Date().toISOString().split("T")[0];S(a);let s=null;return t.com_grafica instanceof File||t.com_grafica instanceof Blob?(s=URL.createObjectURL(t.com_grafica),d(s)):typeof t.com_grafica=="string"?d(t.com_grafica):d(null),()=>{s&&URL.revokeObjectURL(s)}},[]);const{data:t,setData:c,delete:Q,post:W,put:Y,processing:Z,reset:ee,errors:ae}=R({id:"0",com_tipo:"",com_grafica:null,com_titulo:"",com_detalle:"",com_anexo:null,com_fechaPublicacion:"",com_estado:"A"}),k={id:"0",com_tipo:"",com_grafica:null,com_titulo:"",com_detalle:"",com_anexo:null,com_fechaPublicacion:"",com_estado:"A"};o.useState(k);const[m,te]=o.useState(y.acceso),h=a=>{n(!0),v(a),a===1?(p("Adicionar comunicado"),c({id:"0",com_tipo:"",com_grafica:null,com_titulo:"",com_detalle:"",com_anexo:null,com_fechaPublicacion:"",com_estado:"A"})):p("Modificar comunicado")},A=()=>{n(!1)};o.useState(!1);const O=[{value:"",label:"-- Selecciona un tipo --"},{value:"O",label:"Comunidad"},{value:"N",label:"Normatividad"},{value:"C",label:"Contratación"}],I={O:"Comunidad",N:"Normatividad",C:"Contratación"},P=[{value:"",label:"-- Selecciona un estado --"},{value:"A",label:"Activo"},{value:"I",label:"Inactivo"}],L={A:"Activo",I:"Inactivo"},r=a=>{const{name:s,type:l,value:g,files:x}=a.target;l==="file"?c(s,x[0]):c(s,g)},M=(a,s,l)=>{H.mixin({buttonsStyling:!0}).fire({title:"Seguro de eliminar el comunicado "+a+" "+s+" "+l,text:"Se perderá el çomunicad",icon:"question",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Si, eliminar',cancelButtonText:'<i class="fa-solid fa-ban"></i>No, Cancelar'}).then(x=>{x.isConfirmed&&V.Inertia.delete(`/çomunicados/${a}`,{onSuccess:()=>{alert("çomunicad eliminado exitosamente.")},onError:T=>{console.error("Error al eliminar el çomunicad:",T)}})})},E=a=>{a.preventDefault();const s=new FormData;s.append("id",t.id),s.append("com_tipo",t.com_tipo),s.append("com_grafica",t.com_grafica),s.append("com_titulo",t.com_titulo),s.append("com_detalle",t.com_detalle),s.append("com_anexo",t.com_anexo),s.append("com_fechaPublicacion",t.com_fechaPublicacion),s.append("com_estado",t.com_estado),G.post("/comunicados",s,{onSuccess:()=>{alert("Comunicado actualizado exitosamente")},onError:l=>{}})},D=a=>{a.com_anexo?window.open(`/anexos/${a.com_anexo}`,"_blank"):alert("no muestra")};return e.jsx(B,{conjunto:i.conjunto,children:e.jsxs("div",{children:[e.jsx(U,{title:"comunicadoes"}),e.jsxs("div",{className:"p-6",children:[m!=="C"&&e.jsx(e.Fragment,{children:e.jsx("button",{className:"bg-blue-400 text-white px-4 py-1 rounded mb-4",onClick:()=>h(1),children:" Crear Comunicado"})}),e.jsx(q,{href:"/mimenu",className:"bg-green-400 text-white px-4 py-1 mx-4 rounded mb-4",children:" Regreso"}),e.jsx("input",{type:"text",placeholder:"Buscar por título o detalle...",value:C,onChange:a=>w(a.target.value),className:"border rounded px-2 py-1 mb-4"}),e.jsx("span",{className:"mx-10 mt-2 text-blue-500 font-bold text-sm text-center",children:" COMUNICADOS "}),e.jsx("div",{className:"relative"}),e.jsxs("div",{className:"bg-white grid v-screen place-items-center py-1 text-xs",children:[e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"px-2 py-1",children:"#"}),e.jsx("th",{className:"px-2 py-1",children:"TIPO"}),e.jsx("th",{className:"px-2 py-1",children:"TITULO"}),e.jsx("th",{className:"px-2 py-1",children:"DETALLE"}),e.jsx("th",{className:"px-2 py-1",children:"FCH CREA"}),e.jsx("th",{className:"px-2 py-1",children:"GRAFICA"}),e.jsx("th",{className:"px-2 py-1",children:"ANEXO"}),e.jsx("th",{className:"px-2 py-1",children:"ESTADO"}),m!=="super"&&e.jsx("th",{className:"px-2 py-1",colSpan:2,children:"COMANDOS"})]})}),e.jsx("tbody",{children:i.comunicados.data.map(a=>e.jsxs("tr",{className:"text-xs",children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.id}),e.jsxs("td",{className:"border border-gray-400 px-2 py-1",children:[" ",I[a.com_tipo]||"Desconocido"," "]}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.com_titulo}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.com_detalle}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.com_fechaPublicacion}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.com_grafica?e.jsx("img",{src:`/images/${a.com_grafica}`,alt:"Ver Imagen",style:{width:"30px",height:"30px"}}):e.jsx("span",{})}),e.jsx("td",{className:"border border-gray-400 px-0 mx-5 py-1 w-1/64",children:a.com_anexo?e.jsx("div",{onClick:()=>{D(a)},style:{cursor:"pointer"},children:e.jsx("img",{src:"../images/pdf.jpg",alt:"Ver PDF",style:{width:"30px",height:"30px"}})}):e.jsx("span",{})}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:L[a.com_estado]||"Desconocido"}),m!=="C"&&e.jsxs(e.Fragment,{children:[" ",e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:e.jsx("button",{className:"bg-gray-400 hover:bg-gray-700 text-white px-2 py-1 rounded",onClick:()=>{c(a),h(0)},children:"Editar"})}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:e.jsx("button",{className:"bg-red-400 hover:bg-red-700 text-white font-bold py-1 px-1 rounded",onClick:()=>M(a.id,a.com_titulo,a.com_detalle),children:"Eliminar"})})]})]},a.id))})]}),e.jsx(z,{class:"mt-6",links:i.comunicados.links})]}),e.jsxs($,{show:_,onClose:A,children:[e.jsx("h2",{className:"mt-2 text-blue-500 font-bold text-sm text-center",children:N}),e.jsx("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto transform transition-all duration-300 ease-in-out scale-100",children:e.jsx("form",{onSubmit:E,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsx(f,{Id:"com_tipo",Label:"Tipo comunicado",data:t.com_tipo,options:O,OnChange:r,required:!0}),e.jsx(b,{Id:"com_titulo",Type:"text",Label:"Título",onChange:r,classNameI:"md:col-span-2",maxLength:"100",data:t.com_titulo,required:!0,OnChange:r}),e.jsx(J,{Id:"com_detalle",Label:"Detalle",onChange:r,classNameI:"md:col-span-2",Rows:"2",Cols:"120",maxLength:"400",data:t.com_detalle,required:!0,OnChange:r}),e.jsx(b,{Id:"com_fechaPublicacion",Type:"date",Label:"Fecha publicación",onChange:r,maxLength:"100",data:t.com_fechaPublicacion,required:!0,OnChange:r}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"com_anexo",className:"block text-sm font-medium text-gray-700",children:"Anexo en pdf"}),e.jsx("div",{className:"mt-0.5",children:e.jsx("div",{className:"flex rounded-md bg-white outline-1 -outline-offset-1 outline-gray-300 has-[input:focus-within]:outline-2 has-[input:focus-within]:-outline-offset-2 has-[input:focus-within]:outline-indigo-600",children:e.jsx("input",{id:"com_anexo",type:"file",name:"com_anexo",accept:"application/pdf",onChange:r,className:"w-full px-1 py-1 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-100 border-gray-300"})})}),t.com_anexo&&e.jsxs("p",{className:"text-sm text-black mt-1",children:["Archivo seleccionado: ",t.com_anexo.name]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-700 dark:text-gray-300 mb-1",children:"Gráfica que acompaña"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-slate-600 border-dashed rounded-md",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx("img",{src:`/images/${t.com_grafica}`,alt:"Gráfica a cargar",className:"h-10 w-16 aspect-square focus:ring-4"}),e.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("label",{htmlFor:"com_grafica",className:"relative cursor-pointer bg-white dark:bg-slate-800 rounded-md font-medium text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500",children:[e.jsx("span",{children:"Subir un archivo"}),e.jsx("input",{id:"com_grafica",name:"com_grafica",type:"file",className:"sr-only",onChange:r,accept:"image/png, image/jpeg, image/gif"})]}),e.jsx("p",{className:"pl-1",children:"o arrastrar y soltar"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"PNG, JPG, GIF hasta 10MB"})]})})]}),u&&e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Vista Previa"}),e.jsx("img",{src:u,alt:"Vista previa",className:"mx-auto h-32 w-32 object-contain rounded-md bg-gray-100 dark:bg-slate-700 p-1 border border-gray-300 dark:border-slate-600"})]})]}),e.jsx(f,{Id:"com_estado",Label:"Estado",data:t.com_estado,options:P,OnChange:r,required:!0}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-1 rounded",children:"Guardar"}),e.jsx("button",{type:"button",className:"mx-2 bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-1 rounded",onClick:()=>n(!1),children:" Cancelar"})]})]})})})]})]})]})})}export{pe as default};
