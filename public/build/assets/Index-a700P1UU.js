import{V as T,r,h as k,a as A,j as e,U as D}from"./app-Cegcm5kP.js";import{A as M}from"./AuthenticatedLayout-DtXB4yAw.js";import{d as p}from"./index-BfQLVr1a.js";import{M as O}from"./Modal-DRG4MLRd.js";import{S as R}from"./sweetalert2.esm.all-B0Dix5B2.js";import{P as U}from"./Pagination-D1wEGoFR.js";import{M as f}from"./MiInput-CEkF_wN6.js";import{M as F}from"./MiTextArea-iPUdR226.js";import"./transition-CxfPntE9.js";function ae(o,j){const y=T().props.auth.user,[N,n]=r.useState(!1),[_,x]=r.useState(""),[w,v]=r.useState(1),[i,C]=r.useState(j.search||"");r.useEffect(()=>{const a=setTimeout(()=>{k.get("/publicaciones",{search:i},{preserveState:!0,replace:!0})},500);return()=>clearTimeout(a)},[i]);const[P,c]=r.useState(null);r.useState(null);const{data:t,setData:d,delete:q,post:B,put:z,processing:S,reset:G,errors:V}=A({id:"",pub_grafica:null,pub_titulo:"",pub_detalle:"",pub_anexo:null}),[m,$]=r.useState(y.role),h=a=>{n(!0),v(a),a===1?(x("Añadir aviso"),d({pub_grafica:null,pub_titulo:"",pub_detalle:"",pub_anexo:null})):x("Modificar aviso")},I=()=>{n(!1)},E=a=>{if(a.preventDefault(),w===1)try{const s=p.Inertia.post("/publicaciones",t);alert("Datos actualizados exitosamente")}catch(s){console.error("Error al crear el registro:",s)}else{try{const s=p.Inertia.put(`/publicaciones/${t.id}`,t);alert("Datos actualizados exitosamente")}catch(s){console.error("Error al actualizar  el registro:",s)}n(!1)}},L=(a,s)=>{R.mixin({buttonsStyling:!0}).fire({title:"Seguro de eliminar esta publicacion "+a+" "+s,text:"Se perderá la publicacion",icon:"question",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Si, eliminar',cancelButtonText:'<i class="fa-solid fa-ban"></i>No, Cancelar'}).then(u=>{u.isConfirmed&&p.Inertia.delete(`/publicaciones/${a}`,{onSuccess:()=>{alert("aviso eliminado exitosamente.")},onError:g=>{console.error("Error al eliminar publicacion:",g)}})})};r.useState(!1),r.useEffect(()=>{let a=null;return t.pub_grafica instanceof File||t.pub_grafica instanceof Blob?(a=URL.createObjectURL(t.pub_grafica),c(a)):typeof t.pub_grafica=="string"?c(t.con_logo):c(null),()=>{a&&URL.revokeObjectURL(a)}},[t.pub_grafica]);const l=a=>{const{name:s,value:b}=a.target;d(u=>({...u,[s]:b}))};return e.jsx(M,{auth:o.auth,errors:o.errors,conjunto:o.conjunto,children:e.jsxs("div",{className:"p-6",children:[m!=="User"&&e.jsx(e.Fragment,{children:e.jsx("button",{className:"bg-blue-500 text-white px-4 py-1 rounded mb-4",onClick:()=>h(1),children:" Crear Aviso"})}),e.jsx(D,{href:"/mimenu",className:"bg-green-500 text-white px-4 py-1 mx-4 rounded mb-4",children:" Regreso"}),e.jsx("input",{type:"text",placeholder:"Buscar por título o detalle...",value:i,onChange:a=>C(a.target.value),className:"border rounded px-2 py-1 mb-4"}),e.jsx("span",{className:"mx-10 bg-blue-100",children:" AVISOS "}),e.jsxs("div",{className:"bg-white grid v-screen place-items-center py-1 text-xs",children:[e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"px-2 py-1",children:"#"}),e.jsx("th",{className:"px-2 py-1",children:"TITULO"}),e.jsx("th",{className:"px-2 py-1",children:"DESCRIPCION"}),e.jsx("th",{className:"px-2 py-1",children:"ANEXO"}),e.jsx("th",{className:"px-2 py-1",children:"GRAFICA"}),e.jsx("th",{className:"px-2 py-1",colSpan:2})]})}),e.jsx("tbody",{children:o.publicaciones.data.map(a=>e.jsxs("tr",{className:"text-xs",children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.id}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.pub_titulo}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.pub_detalle}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.pub_anexo}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.pub_grafica}),m!=="User"&&e.jsxs(e.Fragment,{children:[" ",e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:e.jsx("button",{className:"bg-yellow-500 text-white px-2 py-1 rounded",onClick:()=>{d(a),h(0)},children:"Editar"})}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:e.jsx("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-1 rounded",onClick:()=>L(a.id,a.pub_titulo),children:"Eliminar"})})]})]},a.id))})]}),e.jsx(U,{class:"mt-6",links:o.publicaciones.links})]}),e.jsxs(O,{show:N,onClose:I,children:[e.jsx("h2",{className:"p-3 text-lg font-medium text-gray-900",children:_}),e.jsx("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto transform transition-all duration-300 ease-in-out scale-100",children:e.jsx("form",{onSubmit:E,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(f,{Id:"pub_titulo",Type:"text",Label:"Título",onChange:l,classNameI:"md:col-span-2",maxLength:"150",data:t.pub_titulo,required:!0,OnChange:l}),e.jsx(F,{Id:"pub_detalle",Label:"Detalle",onChange:l,classNameI:"",Rows:"2",Cols:"100",data:t.pub_detalle,required:!0,OnChange:l}),e.jsx(f,{Id:"pub_anexo",Type:"text",Label:"Anexo en PDF",onChange:l,classNameI:"md:col-span-2",maxLength:"150",data:t.pub_anexo,required:!0,OnChange:l}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"pub_grafica",className:"block text-sm/6 font-semibold text-gray-900",children:"Soporte gráfico"}),e.jsx("div",{className:"mt-0.5",children:e.jsx("div",{className:"flex rounded-md bg-white outline-1 -outline-offset-1 outline-gray-300 has-[input:focus-within]:outline-2 has-[input:focus-within]:-outline-offset-2 has-[input:focus-within]:outline-indigo-600",children:e.jsx("input",{id:"pub_grafica",type:"file",name:"pub_grafica",defaultValue:t.pub_grafica,required:!0,onChange:l,className:"block min-w-0 grow py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm/6"})})})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-1 rounded",onClick:()=>n(!1),children:"Cancelar"}),e.jsx("button",{processing:S,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold mx-3 py-1 px-1 rounded",children:"Guardar"})]})]})})})]})]})})}export{ae as default};
