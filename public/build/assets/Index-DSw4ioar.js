import{V as F,r,a as R,h as f,j as e,M as U,U as v}from"./app-Cegcm5kP.js";import{A as G}from"./AuthenticatedLayout-DtXB4yAw.js";import{d as B}from"./index-BfQLVr1a.js";import{M as P}from"./Modal-DRG4MLRd.js";import{S as q}from"./sweetalert2.esm.all-B0Dix5B2.js";import{P as V}from"./Pagination-D1wEGoFR.js";import{M as j}from"./MiInput-CEkF_wN6.js";import{T as $}from"./TextAreaInput2-DW4_vkZw.js";import"./transition-CxfPntE9.js";function ce(c,y){const N=F().props.auth.user,[_,p]=r.useState(!1),[S,h]=r.useState(""),[H,w]=r.useState(1),[d,C]=r.useState(y.search||""),[k,T]=r.useState(""),[g,u]=r.useState(null),{data:t,setData:l,delete:z,post:J,put:K,processing:Q,reset:W,errors:X}=R({id:"",avi_titulo:"",avi_subtitulo:null,avi_detalle:"",avi_grafica:"",avi_fchpublica:null,avi_estado:""}),I={id:null,avi_titulo:"",avi_subtitulo:"",avi_detalle:"",avi_grafica:null,avi_fchpublica:"",avi_estado:""};r.useEffect(()=>{const a=new Date().toISOString().split("T")[0];T(a);const s=setTimeout(()=>{f.get("/avisos",{search:d},{preserveState:!0,replace:!0})},500);return()=>clearTimeout(s)},[d]),r.useState(c.conjunto),r.useEffect(()=>{let a=null;return t.avi_grafica instanceof File||t.avi_grafica instanceof Blob?(a=URL.createObjectURL(t.avi_grafica),u(a)):typeof t.avi_grafica=="string"?u(t.avi_grafica):u(null),()=>{a&&URL.revokeObjectURL(a)}},[t.avi_grafica]),r.useState(I);const[m,Y]=r.useState(N.acceso),b=a=>{p(!0),w(a),a===1?(h("Adicionar un aviso"),l({avi_titulo:"",avi_subtitulo:"",avi_detalle:"",avi_grafica:null,avi_fchpublica:k,avi_estado:"I"})):h("Modificar un aviso")},A=()=>{p(!1)};r.useState(!1);const E={I:"Iniciado",A:"Aprobado"},o=a=>{const{name:s,type:i,value:n,files:x}=a.target;i==="file"?l(s,x[0]):l(s,n)},D=(a,s,i)=>{q.mixin({buttonsStyling:!0}).fire({title:"Seguro de eliminar el aviso "+a+" "+s+" "+i,text:"Se perderá el aviso",icon:"question",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Si, eliminar',cancelButtonText:'<i class="fa-solid fa-ban"></i>No, Cancelar'}).then(x=>{x.isConfirmed&&B.Inertia.delete(`/avisos/${a}`,{onSuccess:()=>{alert("aviso eliminado exitosamente.")},onError:O=>{console.error("Error al eliminar el aviso:",O)}})})},L=r.useCallback(a=>{var i;const s=(i=a.target.files)==null?void 0:i[0];s&&l(n=>({...n,avi_grafica:s}))},[]),M=a=>{a.preventDefault();const s=new FormData;s.append("id",t.id),s.append("avi_titulo",t.avi_titulo),s.append("avi_subtitulo",t.avi_subtitulo),s.append("avi_detalle",t.avi_detalle),s.append("avi_fchpublica",t.avi_fchpublica),s.append("avi_estado",t.avi_estado),t.avi_grafica&&s.append("avi_grafica",t.avi_grafica),f.post("/avisos",s,{onSuccess:()=>{alert("Datos del formulario actualizados.")},onError:i=>{}})};return e.jsx(G,{conjunto:c.conjunto,children:e.jsxs("div",{children:[e.jsx(U,{title:"avisos"}),e.jsxs("div",{className:"p-6",children:[m!=="C"&&e.jsx(e.Fragment,{children:e.jsx("button",{className:"bg-blue-400 text-white px-4 py-1 rounded mb-4",onClick:()=>b(1),children:" Crear Aviso"})}),e.jsx(v,{href:"/mimenu",className:"bg-green-400 text-white px-4 py-1 mx-4 rounded mb-4",children:" Regreso"}),e.jsx("input",{type:"text",placeholder:"Buscar por título o subtitulo...",value:d,onChange:a=>C(a.target.value),className:"border rounded px-2 py-1 mb-4"}),e.jsx("span",{className:"mx-10 mt-2 text-blue-500 font-bold text-sm text-center",children:" AVISOS "}),e.jsx("div",{className:"relative"}),e.jsxs("div",{className:"bg-white grid v-screen place-items-center py-1 text-xs",children:[e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"px-2 py-1",children:"#"}),e.jsx("th",{className:"px-2 py-1",children:"TITULO"}),e.jsx("th",{className:"px-2 py-1",children:"SUBTITULO"}),e.jsx("th",{className:"px-2 py-1",children:"DETALLE"}),e.jsx("th",{className:"px-2 py-1",children:"GRAFICA"}),e.jsx("th",{className:"px-2 py-1",children:"FCH CREA"}),e.jsx("th",{className:"px-2 py-1",children:"ESTADO"}),m!=="super"&&e.jsx("th",{className:"px-2 py-1",colSpan:2,children:"COMANDOS"})]})}),e.jsx("tbody",{children:c.avisos.data.map(a=>e.jsxs("tr",{className:"text-xs",children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.id}),e.jsxs("td",{className:"border border-gray-400 px-2 py-1",children:[" ",a.avi_titulo," "]}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.avi_subtitulo}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.avi_detalle}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.avi_grafica?e.jsx("div",{children:e.jsx("img",{src:`/images/${a.avi_grafica}`,alt:"grafica acompaña",className:"h-10 w-16 aspect-square focus:ring-4"})}):e.jsx("span",{})}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.avi_fchpublica}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E[a.avi_estado]||"Desconocido"}),m!=="C"&&e.jsxs(e.Fragment,{children:[" ",e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:e.jsx("button",{className:"bg-gray-400 hover:bg-gray-700 text-white px-2 py-1 rounded",onClick:()=>{l(a),b(0)},children:"Editar"})}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:e.jsx("button",{className:"bg-red-400 hover:bg-red-700 text-white font-bold py-1 px-1 rounded",onClick:()=>D(a.id,a.avi_titulo,a.avi_subtitulo),children:"Eliminar"})})]})]},a.id))})]}),e.jsx(V,{class:"mt-6",links:c.avisos.links})]}),e.jsxs(P,{show:_,onClose:A,children:[e.jsx("h2",{className:"mt-2 text-blue-500 font-bold text-sm text-center",children:S}),e.jsx("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto transform transition-all duration-300 ease-in-out scale-100",children:e.jsx("form",{onSubmit:M,className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsx(j,{Id:"avi_titulo",Type:"text",Label:"Título",onChange:o,classNameI:"md:col-span-2",maxLength:"100",data:t.avi_titulo,required:!0,OnChange:o}),e.jsx(j,{Id:"avi_subtitulo",Type:"text",Label:"Sub Título",onChange:o,classNameI:"md:col-span-2",maxLength:"100",data:t.avi_subtitulo,required:!0,OnChange:o}),e.jsx("div",{className:"md:col-span-2",children:e.jsx($,{label:"Detalles Adicionales",name:"avi_detalle",value:t.avi_detalle,onChange:o,rows:2,cols:140,placeholder:"Información relevante ."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-700 dark:text-gray-300 mb-1",children:"Gráfica que acompaña"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-slate-600 border-dashed rounded-md",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx("img",{src:`/images/${t.avi_grafica}`,alt:"Gráfica a cargar",className:"h-10 w-16 aspect-square focus:ring-4"}),e.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("label",{htmlFor:"avi_grafica",className:"relative cursor-pointer bg-white dark:bg-slate-800 rounded-md font-medium text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500",children:[e.jsx("span",{children:"Subir un archivo"}),e.jsx("input",{id:"avi_grafica",name:"avi_grafica",type:"file",className:"sr-only",onChange:L,accept:"image/png, image/jpeg, image/gif"})]}),e.jsx("p",{className:"pl-1",children:"o arrastrar y soltar"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"PNG, JPG, GIF hasta 10MB"})]})})]}),g&&e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Vista Previa"}),e.jsx("img",{src:g,alt:"Vista previa",className:"mx-auto h-32 w-32 object-contain rounded-md bg-gray-100 dark:bg-slate-700 p-1 border border-gray-300 dark:border-slate-600"})]})]}),e.jsx("hr",{}),e.jsx("div",{className:"border-t flex justify-end space-x-3",children:e.jsxs("div",{className:"mt-10",children:[e.jsx(v,{href:"/mimenu",className:"bg-green-500 hover:bg-green-700 text-white px-4 py-1 mx-4 rounded mb-4",children:" Regreso"}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white px-4 py-1 mx-4 rounded mb-4",children:"Guardar"})]})})]})})})]})]})]})})}export{ce as default};
